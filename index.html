<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<meta name="keywords" content="CI/CD Jenkins Pipelines NodeJs Docker KeystoneJs">
<title>Despliegue continuo con GitHub Actions</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sa {
  color: #000000;
  font-weight: bold;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
</head>
<body class="book toc2 toc-right">
<div id="header">
<h1>Despliegue continuo con GitHub Actions</h1>
<div id="toc" class="toc2">
<div id="toctitle">Tabla de contenidos</div>
<ul class="sectlevel0">
<li><a href="#_primeros_pasos_con_github_actions">Primeros pasos con GitHub Actions</a>
<ul class="sectlevel1">
<li><a href="#_comenzando_con_github_actions">Comenzando con GitHub Actions</a>
<ul class="sectlevel2">
<li><a href="#_introducción_a_github_actions">Introducción a GitHub Actions</a></li>
<li><a href="#_creación_del_repositorio">Creación del repositorio</a></li>
<li><a href="#_creando_tu_primer_workflow">Creando tu primer workflow</a></li>
<li><a href="#_comprobando_el_resultado">Comprobando el resultado</a></li>
</ul>
</li>
<li><a href="#_primer_ejemplo_documentación_en_antora">Primer ejemplo: Documentación en Antora</a>
<ul class="sectlevel2">
<li><a href="#_introducción_a_antora">Introducción a Antora</a></li>
<li><a href="#_creación_del_repositorio_2">Creación del repositorio</a></li>
<li><a href="#_creando_el_workflow_para_antora">Creando el workflow para Antora</a></li>
<li><a href="#_descarga_de_los_artefactos_artifacts">Descarga de los artefactos (artifacts)</a></li>
<li><a href="#_despliegue_en_github_pages">Despliegue en GitHub Pages</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_aplicación_en_nodejs">Aplicación en NodeJS</a>
<ul class="sectlevel1">
<li><a href="#_hola_mundo_en_nodejs"><em>Hola mundo</em> en NodeJS</a>
<ul class="sectlevel2">
<li><a href="#_creación_del_repositorio_3">Creación del repositorio</a></li>
<li><a href="#_creación_del_workflow_en_github_actions">Creación del workflow en GitHub Actions</a></li>
<li><a href="#_informe_de_cobertura">Informe de cobertura</a></li>
<li><a href="#_análisis_estático_de_código">Análisis estático de código</a></li>
<li><a href="#_despliegue_en_la_vm">Despliegue en la VM</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Computación en la Nube, Servicios y Aplicaciones. Joaquín Cañadas &lt;<a href="mailto:jjcanada@ual.es">jjcanada@ual.es</a>&gt;, Francisco García &lt;<a href="mailto:paco.garcia@ual.es">paco.garcia@ual.es</a>&gt;</p>
</div>
<div class="paragraph">
<p><em>Version</em> <strong>0.22.2</strong></p>
</div>
<div class="exampleblock">
<div class="title">Objetivos</div>
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Crear una infraestructura de CI/CD en GitHub mediante el uso de GitHub Actions</p>
</li>
<li>
<p>Diseñar flujos de trabajo para la construcción y despliegue automatizado de portales de documentación y aplicaciones NodeJs</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Realización y entrega</div>
<div class="paragraph">
<p>La realización de estas actividades se realizará de forma <strong>individual</strong>. Serán la base para actividades posteriores que ser harán en equipo.
La entrega será mediante el envío de un informe y el acceso al profesor a los servicios configurados por cada estudiante, para la revisión y evaluación de los mismos.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Esta es la versión <strong>0.22.2</strong> de este documento.</p>
</div>
</div>
</div>
<h1 id="_primeros_pasos_con_github_actions" class="sect0">Primeros pasos con GitHub Actions</h1>
<div class="openblock partintro">
<div class="content">
<div class="exampleblock">
<div class="title">Objetivos</div>
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Vamos a crear un repositorio vacio donde crear nuestro primer flujo de trabajo con GitHub Actions.</p>
</li>
<li>
<p>Después, con el <a href="https://github.com/ualcnsa/cicd">repositorio con la documentación de la asignatura</a> crearemos los primeros ejemplos de GitHub Actions que nos permitirán crear artefactos y desplegar la documentación en HTML en GitHub Pages.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comenzando_con_github_actions">Comenzando con GitHub Actions</h2>
<div class="sectionbody">
<div class="exampleblock">
<div class="title">Objetivos</div>
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Comenzar a crear flujos de trabajo (workflows) de GitHub Actions.</p>
</li>
<li>
<p>Probar un flujo de trabajo sencillo para familiarizarse con la plataforma.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_introducción_a_github_actions">Introducción a GitHub Actions</h3>
<div class="paragraph">
<p><strong>GitHub Actions</strong> es una <strong>plataforma</strong> de integración continua y despliegue continuo <strong>(CI/CD)</strong> que permite crear flujos de construcción, test y despliegue en GitHub. Estos flujos de trabajo permiten crear y probar cada solicitud de cambios en tu repositorio o desplegar solicitudes de cambios fusionadas a producción.</p>
</div>
<div class="paragraph">
<p>Sus principales características son:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Permite <strong>automatizar los flujos de trabajo</strong> proporcionando capacidades de <strong>CI/CD</strong> a GitHub.</p>
</li>
<li>
<p><strong>Construye, prueba y despliega</strong> tu código directamente desde GitHub.</p>
</li>
<li>
<p>Permite <strong>integrar</strong> las <strong>revisiones de código</strong>, manejo de <strong>ramas</strong>, resolución de <strong>incidencias</strong> y creación de <strong>releases</strong>.</p>
</li>
<li>
<p>Permite <strong>descubrir, crear y compartir <code>actions</code></strong> para ejecutar cualquier trabajo que quieras.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_creación_del_repositorio">Creación del repositorio</h3>
<div class="paragraph">
<p>Para empezar a trabajar con GitHub Actions solo necesitas un repositorio alojado en GitHub.</p>
</div>
<div class="paragraph">
<p>Para ello seguimos los siguientes pasos:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Al lado de nuestro avatar de usuario, pulsamos en <code>+ &gt; New Repository</code></p>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/first-steps/images/github-new-repository.png" alt="github new repository">
</div>
</div>
</li>
<li>
<p>Creamos un repositorio llamado <code>hello-action</code> de tipo <strong>público</strong>.</p>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/first-steps/images/github-create-repository.png" alt="github create repository">
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Las <strong>GitHub Actions</strong> funcionan tanto con repositorios <strong>públicos</strong> como <strong>privados</strong>. Sin embargo, otras funciones como las <strong>GitHub Pages</strong> solo funcionan con los repositorios <strong>públicos</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_creando_tu_primer_workflow">Creando tu primer workflow</h3>
<div class="paragraph">
<p>A continuación, vamos a añadir un workflow que muestra las características esenciales de GitHub Actions.</p>
</div>
<div class="paragraph">
<p>Este ejemplo muestra como los trabajos de GitHub Actions pueden ser ejecutados automáticamente, donde corren y como interactuan con el código de tu repositorio.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clona en tu equipo el repositorio creado anteriormente.</p>
</li>
<li>
<p>Crea un directorio <code>.github/workflows</code>.</p>
</li>
<li>
<p>En este directorio, crea un fichero llamado <code>github-actions-demo.yml</code>.</p>
</li>
<li>
<p>Copia el siguiente contenido YAML en el fichero anterior.</p>
<div class="listingblock">
<div class="title">github-actions-demo.yml</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="na">name</span><span class="pi">:</span> <span class="s">GitHub Actions Demo</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="na">on</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">push</span><span class="pi">]</span> <i class="conum" data-value="2"></i><b>(2)</b>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">Explore-GitHub-Actions</span><span class="pi">:</span> <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span> <i class="conum" data-value="4"></i><b>(4)</b>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">run</span><span class="pi">:</span> <span class="s">echo "🎉 The job was automatically triggered by a ${{ github.event_name }} event."</span> <i class="conum" data-value="5"></i><b>(5)</b>
      <span class="pi">-</span> <span class="na">run</span><span class="pi">:</span> <span class="s">echo "🐧 This job is now running on a ${{ runner.os }} server hosted by GitHub!"</span>
      <span class="pi">-</span> <span class="na">run</span><span class="pi">:</span> <span class="s">echo "🔎 The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Check out repository code</span> <i class="conum" data-value="6"></i><b>(6)</b>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v2</span> <i class="conum" data-value="7"></i><b>(7)</b>
      <span class="pi">-</span> <span class="na">run</span><span class="pi">:</span> <span class="s">echo "💡 The ${{ github.repository }} repository has been cloned to the runner."</span>
      <span class="pi">-</span> <span class="na">run</span><span class="pi">:</span> <span class="s">echo "🖥️ The workflow is now ready to test your code on the runner."</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">List files in the repository</span>
        <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
          <span class="s">ls ${{ github.workspace }}</span>
      <span class="pi">-</span> <span class="na">run</span><span class="pi">:</span> <span class="s">echo "🍏 This job's status is ${{ job.status }}."</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Nombre del workflow.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Cuando se ejecuta el workflow. En este caso al hacer push en cualquier rama.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Nombre del trabajo.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Máquina donde se ejecuta el trabajo.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Comando de terminal bash.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Nombre del paso.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Reutilización de un <code>action</code> creada por otro usuario. En este caso es la que se utiliza para obtener el código del repositorio.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Hacemos <code>commit</code> de los cambios y hacemos <code>push</code> a la rama remota</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>git add -A &amp;&amp; git commit
git push origin main</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_comprobando_el_resultado">Comprobando el resultado</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Es posible que la <strong>GitHub Actions</strong> no se ejecute instantaneamente y tarde un poco en aparecer. Los recursos son compartidos entre todos los usuarios de GitHub.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>En la página principal del repositorio, selecciona <code>Actions</code> en el menú principal</p>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/first-steps/images/github-menu-actions.png" alt="github menu actions">
</div>
</div>
</li>
<li>
<p>En esta página podemos ver tanto el listado de workflows que tenemos en nuestro repositorio, como las ejecuciones de cada uno. Además podemos ver si ha habido éxito en la ejecución del workflow.</p>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/first-steps/images/github-all-workflows.png" alt="github all workflows">
</div>
</div>
</li>
<li>
<p>Pulsamos en el nombre del commit (<code>hello action</code> en la imagen anterior) y accederemos a un resumen de la ejecución. En esta suelen aparecer las estadísticas de tiempo, los artefactos asociados y cada uno de los trabajos o jobs de nuestro workflow.</p>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/first-steps/images/github-action-summary.png" alt="github action summary">
</div>
</div>
</li>
<li>
<p>Pulsamos en el nombre del trabajo (<code>Explore-GitHub-Actions</code> en la imagen anterior) y vemos una descripción de cada una de los pasos o steps del trabajo.</p>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/first-steps/images/github-action-job-summary.png" alt="github action job summary">
</div>
</div>
</li>
<li>
<p>Además podemos ver el log de ejecución de cada uno de los pasos.</p>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/first-steps/images/github-action-job-step.png" alt="github action job step">
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_primer_ejemplo_documentación_en_antora">Primer ejemplo: Documentación en Antora</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introducción_a_antora">Introducción a Antora</h3>
<div class="paragraph">
<p>Antora permite gestionar la documentación de un proyecto como si fuera código. Esto significa que el proceso de documentación se beneficia de las mismas prácticas utilizadas para producir software con éxito.</p>
</div>
<div class="paragraph">
<p>Algunas de estas prácticas son:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Almacenar el contenido en un sistema de control de versiones.</p>
</li>
<li>
<p>Separar el contenido, la configuración y la presentación.</p>
</li>
<li>
<p>Aprovechar la automatización para la compilación, validación, verificación y publicación.</p>
</li>
<li>
<p>Reutilización de materiales compartidos (DRY).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Antora ayuda a incorporar estas prácticas en el flujo de trabajo de documentación. Como resultado, la documentación es mucho más fácil de gestionar, mantener y mejorar.</p>
</div>
</div>
<div class="sect2">
<h3 id="_creación_del_repositorio_2">Creación del repositorio</h3>
<div class="paragraph">
<p>Para empezar a trabajar solo necesitas un repositorio alojado en GitHub de tipo <strong>público</strong>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Las <strong>GitHub Actions</strong> funcionan tanto con repositorios <strong>públicos</strong> como <strong>privados</strong>. Sin embargo, otras funciones como las <strong>GitHub Pages</strong> solo funcionan con los repositorios <strong>públicos</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>En este repositorio subiremos el contenido de <a href="https://github.com/ualcnsa/cicd/archive/232cf038086dc798e51d5201bba9945277562851.zip">un proyecto de documentación en Antora</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Descomprimimos el archivo en un directorio</p>
</li>
<li>
<p>Entramos al directorio y hacemos <code>git init</code></p>
</li>
<li>
<p>Creamos la rama principal <code>git checkout -b main</code></p>
</li>
<li>
<p>Hacemos commit de todos los archivos con <code>git add -A &amp;&amp; git commit</code></p>
</li>
<li>
<p>Añadimos el remote de nuestro repositorio <code>git remote add origin &lt;dirección-repositorio&gt;</code></p>
</li>
<li>
<p>Subimos la rama local <code>git push origin main`</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Nuestro repositorio tiene que tener la siguiente estructura:</p>
</div>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/first-steps/images/github-antora-files.png" alt="github antora files">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creando_el_workflow_para_antora">Creando el workflow para Antora</h3>
<div class="paragraph">
<p>A continuación, vamos a añadir un workflow que construya nuestro proyecto en Antora.</p>
</div>
<div class="paragraph">
<p>Al tratarse de un proyecto basado en NodeJS, utilizaremos una imagen Docker con éste instalado y seguiremos un proceso de construcción común a éste tipo de proyectos.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Para más información sobre la construcción de proyectos Antora <a href="https://docs.antora.org/antora/latest/install-and-run-quickstart/" class="bare">https://docs.antora.org/antora/latest/install-and-run-quickstart/</a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Crea un directorio <code>.github/workflows</code>.</p>
</li>
<li>
<p>En este directorio, crea un fichero llamado <code>build.yml</code>.</p>
</li>
<li>
<p>Copia el siguiente contenido YAML en el fichero anterior.</p>
<div class="listingblock">
<div class="title">build.yml</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="na">name</span><span class="pi">:</span> <span class="s">CI</span>

<span class="na">on</span><span class="pi">:</span> <i class="conum" data-value="1"></i><b>(1)</b>
  <span class="na">push</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span> <span class="pi">[</span> <span class="nv">main</span> <span class="pi">]</span>
  <span class="na">pull_request</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span> <span class="pi">[</span> <span class="nv">main</span> <span class="pi">]</span>
  <span class="na">workflow_dispatch</span><span class="pi">:</span> <i class="conum" data-value="2"></i><b>(2)</b>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="c1"># The type of runner that the job will run on</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">container</span><span class="pi">:</span> <span class="s">node:16-alpine</span> <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v2</span>

      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install dependencies</span> <i class="conum" data-value="4"></i><b>(4)</b>
        <span class="na">run</span><span class="pi">:</span> <span class="s">npm install</span>

      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Build Antora project</span> <i class="conum" data-value="5"></i><b>(5)</b>
        <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
          <span class="s">cp -R node_modules/@antora/lunr-extension/supplemental_ui/* supplemental-ui/ </span><i class="conum" data-value="6"></i><b>(6)</b>
          <span class="s">npx antora local-antora-playbook.yml --fetch </span><i class="conum" data-value="7"></i><b>(7)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Se ejecuta al hacer <strong>push</strong> en la rama <strong>main</strong> o un <strong>pull request</strong> con destino <strong>main</strong>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Podemos lanzar el workflow cuando queramos.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Utilizamos una imagen Docker con NodeJS 16 instalado.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Instalamos las dependencias del proyecto NodeJS.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Construimos el proyecto Antora.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Paso extra necesario al utilizar la extensión <a href="https://gitlab.com/antora/antora-lunr-extension#user-content-enable-the-search-interface">@antora/lunr-extension</a></td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Comando para construir la documentación Antora a partir del playbook.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Hacemos <code>commit</code> de los cambios y hacemos <code>push</code> a la rama remota</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>git add -A &amp;&amp; git commit
git push origin main</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Podemos comprobar que todo se ha realizado correctamente, viendo el resultado de la acción.</p>
</div>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/first-steps/images/github-antora-build.png" alt="github antora build">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_descarga_de_los_artefactos_artifacts">Descarga de los artefactos (artifacts)</h3>
<div class="paragraph">
<p>Hemos conseguido configurar un workflow que permite compilar la documentación en Antora cada vez que se hace un pull request, un push a main o de forma manual.</p>
</div>
<div class="paragraph">
<p>Sin embargo, no tenemos acceso a la página web que se construye.</p>
</div>
<div class="paragraph">
<p>Si queremos asociar la documentación a cada ejecución tenemos que hacer uso de un action que suba artefactos (artifacts).</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Vamos al <a href="https://github.com/marketplace?type=actions">GitHub Actions Marketplace</a></p>
</li>
<li>
<p>Buscamos la palabra <code>artifact</code>.</p>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/first-steps/images/github-marketplace-artifact.png" alt="github marketplace artifact">
</div>
</div>
</li>
<li>
<p>Seleccionamos <code>Upload a Build Artifact</code> que es un action creado por GitHub.</p>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/first-steps/images/github-marketplace-artifact-desc.png" alt="github marketplace artifact desc">
</div>
</div>
</li>
<li>
<p>Buscamos como utilizar la action en su documentación.</p>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/first-steps/images/github-marketplace-artifact-doc.png" alt="github marketplace artifact doc">
</div>
</div>
</li>
<li>
<p>Modificamos nuestro flujo <code>build.yml`</code> con un paso extra.</p>
<div class="listingblock">
<div class="title">build.yml</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="nn">...</span>
      <span class="c1"># Uploads the generated site</span>
       <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/upload-artifact@v3</span>
         <span class="na">with</span><span class="pi">:</span>
           <span class="na">name</span><span class="pi">:</span> <span class="s">docs</span> <i class="conum" data-value="1"></i><b>(1)</b>
           <span class="na">path</span><span class="pi">:</span> <span class="s">docs/</span> <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Nombre del fichero zip que descargaremos.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Carpeta con la documentación. Por defecto Antora usa el directorio <code>docs</code></td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Tras hacer un push o una pull request, se ejecutará el workflow y podemos descargar la documentación en el zip del final de la página.</p>
</div>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/first-steps/images/github-antora-artifact.png" alt="github antora artifact">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_despliegue_en_github_pages">Despliegue en GitHub Pages</h3>
<div class="paragraph">
<p>Es un servicio de GitHub que ermite publicar páginas en HTML estático o en Jekyll.</p>
</div>
<div class="paragraph">
<p>Además proporciona un dominio y url públicas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://organización.github.io" class="bare">https://organización.github.io</a></p>
</li>
<li>
<p><a href="https://organización.github.io/repositorio" class="bare">https://organización.github.io/repositorio</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Podemos desplegar un sitio web mediante un directorio en el repositorio o con una rama especial (gh-pages).</p>
</div>
<div class="paragraph">
<p>Este servicio es usado normalmente para despliegue de frontends o portales de documentación de repositorios, como el caso que nos ocupa.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Vamos a utilizar el action <a href="https://github.com/marketplace/actions/deploy-to-github-pages"><code>Deploy to GitHub Pages</code></a>.</p>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/first-steps/images/github-marketplace-pages.png" alt="github marketplace pages">
</div>
</div>
</li>
<li>
<p>Leemos la documentación.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Si utilizamos un contenedor tenemos que tener instalado <code>git</code> y <code>rsync</code> para usar esta action.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install rsync and git</span>
  <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
    <span class="s">apt-get update &amp;&amp; apt-get install -y rsync git</span>
    <span class="s"># apk update &amp;&amp; apk add rsync git</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Deploy</span>
  <span class="na">uses</span><span class="pi">:</span> <span class="s">JamesIves/github-pages-deploy-action@v4.2.5</span></code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Modificamos los pasos de nuestro flujo <code>build.yml</code> como primer y último paso</p>
<div class="listingblock">
<div class="title">build.yml</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml">    <span class="na">steps</span><span class="pi">:</span>
       <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install git and rsync 📚</span>
         <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
           <span class="s">apk update &amp;&amp; apk add git rsync</span>

<span class="s">...</span>

      <span class="s">- name</span><span class="err">:</span> <span class="s">Deploy 🚀</span>
         <span class="s">uses</span><span class="err">:</span> <span class="s">JamesIves/github-pages-deploy-action@v4.2.5</span>
         <span class="s">if</span><span class="err">:</span> <span class="s">contains(github.ref,'refs/heads/main')</span> <i class="conum" data-value="1"></i><b>(1)</b>
         <span class="s">with</span><span class="err">:</span>
           <span class="na">branch</span><span class="pi">:</span> <span class="s">gh-pages</span> <i class="conum" data-value="2"></i><b>(2)</b>
           <span class="na">folder</span><span class="pi">:</span> <span class="s">docs</span> <i class="conum" data-value="3"></i><b>(3)</b>
           <span class="na">clean</span><span class="pi">:</span> <span class="no">true</span> <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Solo se ejecuta si hacemos push a la rama main. Evitamos modificar la rama <code>gh-pages</code> al construir una pull request.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>La rama donde vamos a desplegar.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>La carpeta que queremos desplegar.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Si queremos limpiar la rama para evitar que ficheros no existentes se queden en la rama.</td>
</tr>
</table>
</div>
</li>
<li>
<p>Hacemos commit y subimos los cambios.</p>
</li>
<li>
<p>Una vez se ha ejecutado la acción, configuramos el soporte para <strong>GitHub Pages</strong>. Entramos en <code>Settings &gt; Pages</code> y seleccionamos la rama <code>gh-pages</code> como origen.</p>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/first-steps/images/github-pages.png" alt="github pages">
</div>
</div>
</li>
<li>
<p>En esta página podemos consultar la <code>url</code> de la documentación desplegada.</p>
</li>
</ol>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>EJERCICIOS (Optativos)</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Añade un nuevo paso que permita crear un release a partir de la creación de un tag. Puedes basarte en el siguiente <a href="https://github.com/frangarcj/ff3_vita/blob/master/.github/workflows/compilation.yml#L38">ejemplo</a>.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<h1 id="_aplicación_en_nodejs" class="sect0">Aplicación en NodeJS</h1>
<div class="openblock partintro">
<div class="content">
<div class="exampleblock">
<div class="title">Objetivos</div>
<div class="content">
<div class="paragraph">
<p>Como construir y desplegar apliaciones web NodeJS con GitHub Actions</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Definir un flujo de trabajo para automatizar las etapas más habituales en CI/CD</p>
</li>
<li>
<p>Desplegar la aplicación NodeJS tanto de forma nativa como mediante contenedor</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hola_mundo_en_nodejs"><em>Hola mundo</em> en NodeJS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A continuación se muestra un ejemplo de <strong>integración y despliegue continuos en GitHub Actions de un proyecto NodeJS</strong>. Los pasos a realizar son similares a los ejemplos anterior con Jenkins pero adaptaremos las ordenes o comandos a la forma de trabajar de GitHub Actions.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>La implementación de la integración y despliegue continuo permitirá que, para cada pull request en el repositorio, GitHub Actions instale las dependencias y ejecute los tests. Si los tests pasan correctamente, GitHub Actions desplegará la aplicación en el servidor de despliegue. Y si fallan, se notificará al desarrollador.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creación_del_repositorio_3">Creación del repositorio</h3>
<div class="paragraph">
<p>Para empezar a trabajar solo necesitas un repositorio alojado en GitHub de tipo <strong>público</strong>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Las <strong>GitHub Actions</strong> funcionan tanto con repositorios <strong>públicos</strong> como <strong>privados</strong>. Sin embargo, otras funciones como las <strong>GitHub Pages</strong> solo funcionan con los repositorios <strong>públicos</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>En este repositorio subiremos el contenido de <a href="https://github.com/ualcnsa/nodeapp/archive/b96d862ac1b7e2c159c29c2a8552355b01f5cc17.zip">un proyecto HelloWorld en NodeJS</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Descomprimimos el archivo en un directorio</p>
</li>
<li>
<p>Entramos al directorio y hacemos <code>git init</code></p>
</li>
<li>
<p>Creamos la rama principal <code>git checkout -b main</code></p>
</li>
<li>
<p>Hacemos commit de todos los archivos con <code>git add -A &amp;&amp; git commit</code></p>
</li>
<li>
<p>Añadimos el remote de nuestro repositorio <code>git remote add origin &lt;dirección-repositorio&gt;</code></p>
</li>
<li>
<p>Subimos la rama local <code>git push origin main`</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Nuestro repositorio tiene que tener la siguiente estructura:</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Comprueba que los archivos <code>main.js</code>, <code>app.js</code> y  <code>app.test.js</code>, así como la carpeta <code>services</code>, estén dentro de una carpeta <code>src</code>. Si no es así, crea la carpeta <code>src</code> y muevelos dentro.</p>
</div>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/node-app/images/node-files-initial-point.png" alt="node files initial point">
</div>
<div class="title">Fig. 1. Archivos y carpetas en el estado inicial</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_creación_del_workflow_en_github_actions">Creación del workflow en GitHub Actions</h3>
<div class="paragraph">
<p>Creamos un nuevo workflow <code>.github/workflows/build.yml</code></p>
</div>
<div class="listingblock">
<div class="title">.github/workflows/build.yml</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"> <span class="na">name</span><span class="pi">:</span> <span class="s">CI</span>

 <span class="na">on</span><span class="pi">:</span>
   <span class="na">push</span><span class="pi">:</span>
     <span class="na">branches</span><span class="pi">:</span> <span class="pi">[</span> <span class="nv">master</span> <span class="pi">]</span> <i class="conum" data-value="1"></i><b>(1)</b>
   <span class="na">pull_request</span><span class="pi">:</span>
     <span class="na">branches</span><span class="pi">:</span> <span class="pi">[</span> <span class="nv">master</span> <span class="pi">]</span>
   <span class="na">workflow_dispatch</span><span class="pi">:</span>

 <span class="na">jobs</span><span class="pi">:</span>
   <span class="na">build</span><span class="pi">:</span>
     <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
     <span class="na">container</span><span class="pi">:</span> <span class="s">node:16-alpine</span>

     <span class="na">steps</span><span class="pi">:</span>
       <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v2</span>

       <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install dependencies</span>
         <span class="na">run</span><span class="pi">:</span> <span class="s">npm install</span>

       <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Test</span>
         <span class="na">run</span><span class="pi">:</span> <span class="s">npm run test-jenkins</span> <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>El nombre de la rama <code>master</code> o <code>main</code> depende de cual es la rama principal.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Ejecuta los tests de igual forma a como los definimos para Jenkins.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>El resultado sera:</p>
</div>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/node-app/images/github-action-nodejs-test.png" alt="github action nodejs test">
</div>
<div class="title">Fig. 2. Nodeapp action</div>
</div>
<div class="paragraph">
<p>Sin embargo nos interesaría verlo de una forma más visual e integrado en el entorno de GitHub utilizando el action <a href="https://github.com/dorny/test-reporter">Test Reporter</a>. Esta acción permite anotar las pull requests con un test en formato junit.</p>
</div>
<div class="paragraph">
<p>Editamos <code>.github/workflows/build.yml</code> y añadimos la acción para subir un artefacto con los resultados de los tests.</p>
</div>
<div class="listingblock">
<div class="title">.github/workflows/build.yml</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="nn">...</span>
      <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/upload-artifact@v2</span>
         <span class="s">if</span><span class="err">:</span> <span class="s">success() || failure()</span> <i class="conum" data-value="1"></i><b>(1)</b>
         <span class="s">with</span><span class="err">:</span>
           <span class="na">name</span><span class="pi">:</span> <span class="s">test-results</span> <i class="conum" data-value="2"></i><b>(2)</b>
           <span class="na">path</span><span class="pi">:</span> <span class="s">./coverage/test.results.xml</span> <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Ejecutamos el paso independiente de los fallos.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Nombre del artefacto.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Ruta del resultado de los tests.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Además añadimos otro flujo que anote la pull request llamado <code>.github/workflows/tests.yml</code></p>
</div>
<div class="listingblock">
<div class="title">.github/workflows/tests.yml</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="na">name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Test</span><span class="nv"> </span><span class="s">Report'</span>
 <span class="na">on</span><span class="pi">:</span>
   <span class="na">workflow_run</span><span class="pi">:</span>
     <span class="na">workflows</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">CI'</span><span class="pi">]</span> <i class="conum" data-value="1"></i><b>(1)</b>
     <span class="na">types</span><span class="pi">:</span>
       <span class="pi">-</span> <span class="s">completed</span>
 <span class="na">jobs</span><span class="pi">:</span>
   <span class="na">report</span><span class="pi">:</span>
     <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span> <i class="conum" data-value="2"></i><b>(2)</b>
     <span class="na">steps</span><span class="pi">:</span>
     <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">dorny/test-reporter@v1</span>
       <span class="na">with</span><span class="pi">:</span>
         <span class="na">artifact</span><span class="pi">:</span> <span class="s">test-results</span>              <i class="conum" data-value="3"></i><b>(3)</b>
         <span class="na">name</span><span class="pi">:</span> <span class="s">JEST Tests</span>                    <i class="conum" data-value="4"></i><b>(4)</b>
         <span class="na">path</span><span class="pi">:</span> <span class="s1">'</span><span class="s">test.results.xml'</span>            <i class="conum" data-value="5"></i><b>(5)</b>
         <span class="na">reporter</span><span class="pi">:</span> <span class="s">jest-junit</span>                <i class="conum" data-value="6"></i><b>(6)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Se ejecuta cuando se completa el flujo llamado <code>CI</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>No hace falta contenedor.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Nombre del artefacto con los tests.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Nombre del check.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Nombre de los resultados dentro del zip.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Formato de los resultados.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Subimos los cambios y podemos comprobar el resultado en los <code>Checks</code>.</p>
</div>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/node-app/images/github-action-check-jest.png" alt="github action check jest">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_informe_de_cobertura">Informe de cobertura</h3>
<div class="paragraph">
<p>Como ya sabemos, la cobertura de código nos va a ofrecer un valor directamente relacionado con la calidad de los juegos de prueba. Para obtener la cobertura y publicarla en GitHub Actions, debemos hacer:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Utilizar un action que se encarge de la publicación de la cobertura como <a href="https://github.com/mattallty/jest-github-action">Jest Github Action</a>.</p>
</li>
<li>
<p>Modificar el paso <em>Test</em> del flujo de GitHub Actions para que llame al script de cobertura y publique el informe de cobertura generado.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Modifica <code>.github/workflows/build.yml</code>, cambiando el paso <code>Test</code> por la ejecución del action.</p>
</li>
<li>
<p>Además pública todos los tests como artifact.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">.github/workflows/build.yml</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml">   <span class="s">...</span>
      <span class="s">- name</span><span class="err">:</span> <span class="s">Test</span>
        <span class="s">uses</span><span class="err">:</span> <span class="s">mattallty/jest-github-action@v1</span>
        <span class="s">env</span><span class="err">:</span>
          <span class="na">GITHUB_TOKEN</span><span class="pi">:</span> <span class="s">${{ secrets.GITHUB_TOKEN }}</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">test-command</span><span class="pi">:</span> <span class="s2">"</span><span class="s">npm</span><span class="nv"> </span><span class="s">run</span><span class="nv"> </span><span class="s">coverage-jenkins"</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="err">   </span><span class="s">...</span>
      <span class="s">- uses</span><span class="err">:</span> <span class="s">actions/upload-artifact@v2</span>
        <span class="s">if</span><span class="err">:</span> <span class="s">success() || failure()</span>
        <span class="s">with</span><span class="err">:</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">test-results</span>
          <span class="na">path</span><span class="pi">:</span> <span class="s">./coverage/test.results.xml</span>
          <span class="na">path</span><span class="pi">:</span> <span class="pi">|</span>
            <span class="s">./coverage/ </span><i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Genera los tests de cobertura.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Subimos la carpeta completa.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Podemos probar realizando un pull request de prueba.</p>
</div>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/node-app/images/github-action-coberture.png" alt="github action coberture">
</div>
<div class="title">Fig. 3. Ejecución de cobertura</div>
</div>
</div>
<div class="sect2">
<h3 id="_análisis_estático_de_código">Análisis estático de código</h3>
<div class="paragraph">
<p>El código JavaScript es dinámicamente tipado, por lo que en lugar de usar el compilador para realizar el análisis estático de código, como ocurre en lenguajes como Java, las formas más comunes de <a href="https://medium.com/codecademy-engineering/static-analysis-in-javascript-a-technical-introduction-859de5d444a6">análisis estático en JavaScript</a> son <em>formatters</em> y <em>linters</em>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Formatters</em> o formateadores, escanean y reformatean rápidamente los archivos de código. Uno de los más populares es <a href="https://prettier.io/">Prettier</a>, que como cualquier buen formateador, corregirá automaticamente las inconsistencias que encuentre.</p>
</li>
<li>
<p><em>Linters</em> pueden trabajar en aspectos de formato pero también otros problemas más complejos. Se basan en una serie de reglas para escanear el código, o descripciones de comportamientos a vigilar, y muestran todas las violaciones que encuentran. El más popular para JavaScript es <a href="https://eslint.org/">ESLint</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Vamos a probar <strong>ESLint con Prettier</strong> en GitHub Actions con la action <a href="https://github.com/ataylorme/eslint-annotate-action">ESLint Annotate from Report JSON</a>. Para utilizarla, vamos a añadir al <code>package.json</code> un script para <code>lint</code> en formato json</p>
</div>
<div class="listingblock">
<div class="title">package.json: lint y dependencia a ESLint</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="w">   </span><span class="err">...</span><span class="w">
   </span><span class="nl">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="err">...</span><span class="w">
      </span><span class="nl">"lint:json"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eslint src/**/*.js --format json -o coverage/eslint-result.json"</span><span class="w">
   </span><span class="p">}</span><span class="err">,</span><span class="w">
   </span><span class="err">...</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>En nuestro flujo <code>.github/workflows/build.yml</code>, añade dos nuevos pasos: uno en el que llames a <code>lint:json</code> y otro que ejecute la action para anotar el código.</p>
</div>
<div class="listingblock">
<div class="title">.github/workflows/build.yml</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="nn">...</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Save Code Linting Report JSON</span>
         <span class="s">run</span><span class="err">:</span> <span class="s">npm run lint:json</span>
         <span class="s">continue-on-error</span><span class="err">:</span> <span class="no">true</span> <i class="conum" data-value="1"></i><b>(1)</b>

       <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Annotate Code Linting Results</span>
         <span class="na">uses</span><span class="pi">:</span> <span class="s">ataylorme/eslint-annotate-action@1.2.0</span>
         <span class="na">with</span><span class="pi">:</span>
           <span class="na">repo-token</span><span class="pi">:</span> <span class="s2">"</span><span class="s">${{</span><span class="nv"> </span><span class="s">secrets.GITHUB_TOKEN</span><span class="nv"> </span><span class="s">}}"</span> <i class="conum" data-value="2"></i><b>(2)</b>
           <span class="na">report-json</span><span class="pi">:</span> <span class="s2">"</span><span class="s">./coverage/eslint-result.json"</span> <i class="conum" data-value="3"></i><b>(3)</b>
<span class="nn">...</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Continua ejecutando el flujo aunque se produzca un error.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Esta action necesita un token para poder anotar el código. Esta disponible sin realizar más acciones.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Ruta del informe de ESLint.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Podemos probar realizando un pull request de prueba y viendo el resultado en la pestaña <code>Files Changed</code>.</p>
</div>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/node-app/images/github-action-eslint-result.png" alt="github action eslint result">
</div>
<div class="title">Fig. 4. Ejecución de ESLint</div>
</div>
</div>
<div class="sect2">
<h3 id="_despliegue_en_la_vm">Despliegue en la VM</h3>
<div class="paragraph">
<p>Para desplegar la aplicación <em>hello world</em> en la instancia de despliegue vamos a clonar el repositorio y a continuación ejecutaremos en ella la orden de Node para ponerla en marcha.</p>
</div>
<div class="paragraph">
<p>Recuerda que ya he hemos realizado una configuración previa sobre la instancia de despliegue, que constituyen los  <strong>prerrequisitos</strong> para esta sección:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Con anterioridad ya instalamos NodeJS en la instancia de despliegue.</p>
</li>
<li>
<p>Tenemos creado un par de claves y hemos copiado la clave pública de despliegue al <code>authorized_keys</code> para que GitHub pueda ejecutar comandos sobre ella usando la clave privada.</p>
</li>
<li>
<p>Como requisito adicional, para ayudarnos a lanzar <code>npm start</code> desde GitHub Actions, como un proceso demonio en background, usaremos <a href="https://www.npmjs.com/package/forever"><strong>forever</strong></a>. Debes instalar <code>forever</code> en la  instancia de despliegue:</p>
<div class="literalblock">
<div class="content">
<pre>sudo npm install forever -g</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Una vez revisados los prerrequisitos, vamos a configurar nuestro repositorio de GitHub para que pueda realizar el despliegue.</p>
</div>
<div class="sect3">
<h4 id="_añadir_la_clave_privada_a_los_secretos_del_repositorio">Añadir la clave privada a los secretos del repositorio.</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ve a tu repositorio en Github y entra en <code>Settings &gt; Secrets</code>.</p>
</li>
<li>
<p>Crea un nuevo secreto con <code>New Repository Secret</code>. Este secreto contiene dos cosas: un nombre y el valor. El nombre se utiliza para obtener el valor más tarde en un flujo de trabajo de Github Actions.</p>
</li>
<li>
<p>Introduce como nombre <code>SSH_PRIVATE_KEY</code>.</p>
</li>
<li>
<p>Copia y pega el contenido de la clave privada como el valor.</p>
</li>
</ol>
</div>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/node-app/images/github-action-new-secret.png" alt="github action new secret">
</div>
<div class="title">Fig. 5. Nuevo secreto</div>
</div>
</div>
<div class="sect3">
<h4 id="_añadir_la_clave_privada_al_flujo_de_trabajo_de_github_actions">Añadir la clave privada al flujo de trabajo de Github Actions</h4>
<div class="paragraph">
<p>Ahora tenemos que añadir la clave privada a la máquina o contenedor de nuestro flujo de trabajo. Para simplificar el proceso podemos usar una action como <a href="https://github.com/marketplace/actions/install-ssh-key">Install SSH Key</a>. Además, vamos a realizar el despliegue en un flujo nuevo <code>.github/workflows/deploy.yml</code> que solo se ejecute al hacer push sobre la rama principal.</p>
</div>
<div class="listingblock">
<div class="title">.github/workflows/deploy.yml</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="na">name</span><span class="pi">:</span> <span class="s">Deploy</span>
<span class="na">on</span><span class="pi">:</span>
  <span class="na">push</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span> <span class="pi">[</span> <span class="nv">master</span> <span class="pi">]</span>
  <span class="na">workflow_dispatch</span><span class="pi">:</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">deploy</span><span class="pi">:</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install SSH Key</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">shimataro/ssh-key-action@v2</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">key</span><span class="pi">:</span> <span class="s">${{ secrets.SSH_PRIVATE_KEY }}</span> <i class="conum" data-value="1"></i><b>(1)</b>
          <span class="na">known_hosts</span><span class="pi">:</span> <span class="s1">'</span><span class="s">un-valor-para-que-no-de-error'</span> <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Nombre del secreto con la clave privada.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Valor del known_hosts de la máquina a la que nos conectamos. Metemos un valor de ejemplo para calcularlo dinámicamente en pasos posteriores.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_añadir_un_valor_correcto_de_known_hosts">Añadir un valor correcto de known_hosts</h4>
<div class="paragraph">
<p>Vamos a guardar como secreto la IP o nombre de dominio de la máquina de despliegue con el nombre de <code>SSH_HOST</code>. Con este valor, vamos a añadir un paso que obtenga el <code>known_hosts</code> y lo escriba.</p>
</div>
<div class="listingblock">
<div class="title">.github/workflows/deploy.yml</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="nn">...</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Adding Known Hosts</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">ssh-keyscan -H ${{ secrets.SSH_HOST }} &gt;&gt; ~/.ssh/known_hosts</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_añadir_el_código_de_despliegue">Añadir el código de despliegue</h4>
<div class="paragraph">
<p>De forma similar a como lo haciamos con Jenkins, vamos a añadir un último paso que realize el despliegue mediante ssh.</p>
</div>
<div class="listingblock">
<div class="title">.github/workflows/deploy.yml</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml">      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Deploy</span>
         <span class="s">run</span><span class="err">:</span> <span class="pi">|</span>
           <span class="s">ssh ubuntu@${{ secrets.SSH_HOST }} "if [ ! -d 'nodeapp' ]; then \</span>
               <span class="s">git clone https://github.com/ualcnsa/nodeapp.git; \ </span><i class="conum" data-value="1"></i><b>(1)</b>
             <span class="s">else \</span>
               <span class="s">cd nodeapp &amp;&amp; git stash &amp;&amp; git fetch --all &amp;&amp; git reset --hard origin/master &amp;&amp; git pull origin master; \</span>
             <span class="s">fi"</span>
           <span class="s">ssh ubuntu@${{ secrets.SSH_HOST }} "if pgrep node; then forever stopall; fi"</span>
           <span class="s">ssh ubuntu@${{ secrets.SSH_HOST }} "cd nodeapp &amp;&amp; npm install"</span>
           <span class="s">ssh ubuntu@${{ secrets.SSH_HOST }} "cd nodeapp &amp;&amp; forever start src/main.js"</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Nombre del repositorio a desplegar.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Podemos acceder a la aplicación mediante el puerto 3000. Si no se puede acceder, habrá que abrirlo en la consola de Google Cloud.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="imageblock text-center thumb">
<div class="content">
<img src="modules/node-app/images/github-action-deploy-result.png" alt="github action deploy result">
</div>
<div class="title">Fig. 6. Resultado del despliegue</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>EJERCICIOS (Optativos)</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Crea un nuevo flujo de despliegue, similar al creado en Jenkins, que utilize Docker. Puedes hacerlo de forma manual (mediante script) o busca actions que te ayuden a publicarlo en el registro de Google Cloud.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Referencias</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://zellwk.com/blog/github-actions-deploy/">Deploying to a server via SSH and Rsync in a Github Action</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-03-31 08:03:45 UTC
</div>
</div>
</body>
</html>