= Comenzando con GitHub Actions

.Objetivos
====
* Comenzar a crear flujos de trabajo (workflows) de GitHub Actions.
* Probar un flujo de trabajo sencillo para familiarizarse con la plataforma.
====

== Introducci√≥n a GitHub Actions

*GitHub Actions* es una *plataforma* de integraci√≥n continua y despliegue continuo *(CI/CD)* que permite crear flujos de construcci√≥n, test y despliegue en GitHub. Estos flujos de trabajo permiten crear y probar cada solicitud de cambios en tu repositorio o desplegar solicitudes de cambios fusionadas a producci√≥n.

Sus principales caracter√≠sticas son:

* Permite *automatizar los flujos de trabajo* proporcionando capacidades de *CI/CD* a GitHub.
* *Construye, prueba y despliega* tu c√≥digo directamente desde GitHub.
* Permite *integrar* las *revisiones de c√≥digo*, manejo de *ramas*, resoluci√≥n de *incidencias* y creaci√≥n de *releases*.
* Permite *descubrir, crear y compartir `actions`* para ejecutar cualquier trabajo que quieras.

== Creaci√≥n del repositorio

Para empezar a trabajar con GitHub Actions solo necesitas un repositorio alojado en GitHub.

Para ello seguimos los siguientes pasos:

1. Al lado de nuestro avatar de usuario, pulsamos en `+ > New Repository`
+
image::github-new-repository.png[role="thumb", align="center"] 

2. Creamos un repositorio llamado `hello-action` de tipo *p√∫blico*.
+
image::github-create-repository.png[role="thumb", align="center"] 

[NOTE]
====
Las *GitHub Actions* funcionan tanto con repositorios *p√∫blicos* como *privados*. Sin embargo, otras funciones como las *GitHub Pages* solo funcionan con los repositorios *p√∫blicos*.
====

== Creando tu primer workflow

A continuaci√≥n, vamos a a√±adir un workflow que muestra las caracter√≠sticas esenciales de GitHub Actions.

Este ejemplo muestra como los trabajos de GitHub Actions pueden ser ejecutados autom√°ticamente, donde corren y como interactuan con el c√≥digo de tu repositorio.

1. Clona en tu equipo el repositorio creado anteriormente.
2. Crea un directorio `.github/workflows`.
3. En este directorio, crea un fichero llamado `github-actions-demo.yml`.
4. Copia el siguiente contenido YAML en el fichero anterior.
+
.github-actions-demo.yml
[source, yaml]
----
name: GitHub Actions Demo <1>
on: [push] <2>
jobs:
  Explore-GitHub-Actions: <3>
    runs-on: ubuntu-latest <4>
    steps:
      - run: echo "üéâ The job was automatically triggered by a ${{ github.event_name }} event." <5>
      - run: echo "üêß This job is now running on a ${{ runner.os }} server hosted by GitHub!"
      - run: echo "üîé The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
      - name: Check out repository code <6>
        uses: actions/checkout@v2 <7>
      - run: echo "üí° The ${{ github.repository }} repository has been cloned to the runner."
      - run: echo "üñ•Ô∏è The workflow is now ready to test your code on the runner."
      - name: List files in the repository
        run: |
          ls ${{ github.workspace }}
      - run: echo "üçè This job's status is ${{ job.status }}."
----
<1> Nombre del workflow.
<2> Cuando se ejecuta el workflow. En este caso al hacer push en cualquier rama.
<3> Nombre del trabajo.
<4> M√°quina donde se ejecuta el trabajo.
<5> Comando de terminal bash.
<6> Nombre del paso.
<7> Reutilizaci√≥n de un `action` creada por otro usuario. En este caso es la que se utiliza para obtener el c√≥digo del repositorio.

5. Hacemos `commit` de los cambios y hacemos `push` a la rama remota
+
```
git commit -a
git push origin main
```

== Comprobando el resultado

[IMPORTANT]
====
Es posible que la *GitHub Actions* no se ejecute instantaneamente y tarde un poco en aparecer. Los recursos son compartidos entre todos los usuarios de GitHub.
====

1. En la p√°gina principal del repositorio, selecciona `Actions` en el men√∫ principal
+
image::github-menu-actions.png[role="thumb", align="center"] 
2. En esta p√°gina podemos ver tanto el listado de workflows que tenemos en nuestro repositorio, como las ejecuciones de cada uno. Adem√°s podemos ver si ha habido √©xito en la ejecuci√≥n del workflow.
+
image::github-all-workflows.png[role="thumb", align="center"]
3. Pulsamos en el nombre del commit (`hello action` en la imagen anterior) y accederemos a un resumen de la ejecuci√≥n. En esta suelen aparecer las estad√≠sticas de tiempo, los artefactos asociados y cada uno de los trabajos o jobs de nuestro workflow.
+
image::github-action-summary.png[role="thumb", align="center"]
4. Pulsamos en el nombre del trabajo (`Explore-GitHub-Actions` en la imagen anterior) y vemos una descripci√≥n de cada una de los pasos o steps del trabajo.
+
image::github-action-job-summary.png[role="thumb", align="center"]
5. Adem√°s podemos ver el log de ejecuci√≥n de cada uno de los pasos.
+
image::github-action-job-step.png[role="thumb", align="center"]